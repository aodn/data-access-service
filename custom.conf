# Ngnix run within docker to redirect some call out of the process
# Custom location for /health: Serve static file, no proxy to uWSGI
server {
    listen 80;  # Change to ${LISTEN_PORT:-80} if using env vars
    server_name _;  # Catch-all; or NGINX_SERVER_NAME env var
    location = /api/v1/das/health {
        root /tmp/status;  # Points to your static dir
        try_files /health.json =404;  # Serve health.json or 404
        add_header Content-Type application/json always;
        access_log off;  # Optional: Skip logging for perf
    }

    location = /api/v1/das/health/ {
        rewrite ^ /api/v1/das/health permanent;
    }
}

# Optional: If you have other static paths, add them here
# location /static/ { alias /app/static/; }

# The default config handles the rest: Proxy / to uWSGI
# (No need to redefine unless overriding)
